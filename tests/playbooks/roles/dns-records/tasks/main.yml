---

- name: Check if a DNS record exist
  changed_when: false
  shell: >-
    dig +noall +answer -t {{ records.type }}
    @127.0.0.1 {{ record.name }}
    | grep '^{{ record.name }}'
    | grep -E '{{ record.value }}'
  with_items:
    - '{{ records.list }}'
  loop_control:
    loop_var: record
